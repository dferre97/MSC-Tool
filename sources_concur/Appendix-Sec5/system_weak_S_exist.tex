
%\begin{figure}
  \begin{center}

  \begin{tikzpicture}[>=stealth,node distance=3.5cm,shorten >=1pt,
      every state/.style={text=black, scale =0.65}, semithick,
      font={\fontsize{8pt}{12}\selectfont}]
	% %P
	  \begin{scope}[->]
	      \node[state,initial,initial text={}] (q0)  {$\ell_p^0$};
	      \node[state, right of=q0] (q1)  {$\ell_p^1$};
				\node[state, right of=q1] (q2) {$\ell_p^2$};

	    	\path (q0) edge node [below] {$\send{p}{q}{\msg_1}$} (q1);
				\path (q1) edge node [below] {$\rec{q}{p}{\msg_2}$}(q2);
				\path (q2) edge [loop above] node [above]   {$~\rec{q}{p}{\msg_2}$}(q2);

	    	\node[rectangle, thick, draw] at (-0.7,0.4) {$A_p$};
	  \end{scope}

	  \begin{scope}[->, shift={(6.5,0)} ]
	      \node[state,initial,initial text={}] (q0)  {$\ell_q^0$};
				\node[state, right of=q0] (q1)  {$\ell_q^1$};
				\node[state, right of=q1] (q2) {$\ell_q^2$};

				\path (q0) edge node [below] {$\send{q}{p}{\msg_2}$} (q1);
				\path (q1) edge [loop above] node [above]   {$~\send{q}{p}{\msg_2}$}(q1);
				\path (q1) edge node [below] {$\rec{r}{q}{\msg_3}$}(q2);
				\node[rectangle, thick, draw] at (-0.7,0.4) {$A_q$};
	  \end{scope}

		\begin{scope}[->, shift={(4.5,-1.3)} ]
	      \node[state,initial,initial text={}] (q0)  {$\ell_r^0$};
				\node[state, right of=q0] (q1)  {$\ell_r^1$};

				\path (q0) edge node [below] {$\send{r}{q}{\msg_3}$} (q1);
				\node[rectangle, thick, draw] at (-0.7,0.4) {$A_r$};
			%\node at (1, -.7) {\textbf{(a)}};

	  \end{scope}
		% \begin{scope}[shift = {(8,0.5)}, scale = 0.8]
		% 	\draw (1, -4.25) node{\textbf{(b) existe plus haut}};
    %   \node at (-9, -4.25) {\textbf{(a)}};
    %
		% 	%MACHINES
		% 	\draw (0,0) node{$p$} ;
		% 	\draw (1,0) node{$q$} ;
		% 	\draw (2,0) node{$r$} ;
		% 	\draw (0,-0.25) -- (0,-3.5) ;
		% 	\draw (1,-0.25) -- (1,-3.5);
		% 	\draw (2, -0.25) -- (2, -3.5) ;
		% 	%MESSAGES
		% 	\draw[>=latex,->, dashed] (0,-0.75) -- (1, -0.75) node[midway,above]{$\amessage_1$};
    %
		% 	\draw[>=latex,->] (1, -1.5) -- (0, -1.5) node[midway, above] {$\amessage_2$};
		% 	\draw (0.5,-1.7) node{$\cdots$};
		% 	\draw[>=latex,->] (1, -2.25) -- (0, -2.25) node[midway, above] {$\amessage_2$};
    %
		% 	\draw[>=latex,->] (2,-3) -- (1,-3) node[midway, above] {$\amessage_3$};
		% \end{scope}
\end{tikzpicture}
\captionof{figure}{System $\systemweakSexist$}
\label{fig:system_weak_S_exist}

\end{center}
%\end{figure}
