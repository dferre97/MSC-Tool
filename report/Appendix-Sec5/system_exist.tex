


%\begin{figure}
  \begin{center}
      \begin{tikzpicture}[>=stealth,node distance=3.4cm,shorten >=1pt,
      every state/.style={text=black, scale =0.65}, semithick,
        font={\fontsize{8pt}{12}\selectfont}]
	% %P
  \begin{scope}[->]
     \node[state,initial,initial text={}] (q0)  {$\ell_p^0$};
     \node[state, right of=q0] (q1)  {$\ell_p^1$};
     \node[state, right of=q1] (q2) {$\ell_p^2$};

     \path (q0) edge node [above] {$\send{p}{q}{\msg_1}$} (q1);
     \path (q1) edge[bend left = 10] node [above] {$\send{p}{q}{\msg_1}$}(q2);
     \path (q2) edge[bend left = 10] node [below] {$\rec{q}{p}{\msg_2}$}(q1);

     \node[rectangle, thick, draw] at (-0.6,0.5) {$A_p$};
 \end{scope}

 \begin{scope}[->, shift={(6,0)}]
     \node[state,initial,initial text={}] (q0)  {$\ell_q^0$};
     \node[state, right of=q0] (q1)  {$\ell_q^1$};

     \path (q0) edge[bend left = 10] node [above] {$\send{q}{p}{\msg_2}$} (q1);
      \path (q1) edge[bend left = 10] node [below] {$\rec{p}{q}{\msg_1}$} (q0);
      \path (q0) edge [loop below] node [below]   {$~\send{q}{r}{\msg_3}$}(q0);
      \path (q1) edge [loop below] node [below]   {$~\send{q}{r}{\msg_3}$}(q1);


     \node[rectangle, thick, draw] at (-0.6,0.5) {$A_q$};
 \end{scope}

\begin{scope}[->, shift ={(11, 0)}]
   \node[state,initial,initial text={}] (q0)  {$\ell_r^0$};
   \path (q0) edge [loop below] node [below]   {$~\rec{q}{r}{\msg_3}$}(q0);
   \node[rectangle, thick, draw] at (-0.6,0.5) {$A_r$};

\end{scope}


		% \begin{scope}[shift = {(7.5,0.5)}, scale = 0.8]
    %   \draw (1.25, -4.75) node{\textbf{(b existe plus haut)}};
    %   \draw (-8, -4.75) node{\textbf{(a)}};
    %
		% 	%MACHINES
		% 	\draw (0,0) node{$p$} ;
		% 	\draw (1.25,0) node{$q$} ;
    %   \draw (2.5,0) node{$r$} ;
		% 	\draw (2.5, -0.25) -- (2.5, -3.75) ;
		% 	\draw (0,-0.25) -- (0,-3.75) ;
		% 	\draw (1.25,-0.25) -- (1.25,-3.75);
		% 	%MESSAGES
    %
    %   \draw[>=latex,->] (0, -0.5) -- (1.25, -1.25) node[pos=0.4, sloped, above] {$\amessage_1$};
    %   \draw[>=latex,->] (0, -1.5) -- (1.25, -2.25) node[pos=0.5, sloped, above] {$\amessage_1$};
    %   \draw[>=latex,->] (0, -2.5) -- (1.25, -3.25) node[pos=0.65, sloped, above] {$\amessage_1$};
    %
    %   \draw[>=latex,->] (1.25, -0.75) -- (0, -2) node[pos=0.5, sloped, above] {$\amessage_2$};
    %   \draw[>=latex,->] (1.25, -1.75) -- (0, -3) node[pos=0.5, sloped, above] {$\amessage_2$};
    %
    %   \draw[>=latex,->] (1.25, -1) -- (2.5, -1) node[midway, above] {$\amessage_3$};
    %   \draw[>=latex,->] (1.25, -1.5) -- (2.5, -1.5) node[midway, above] {$\amessage_3$};
    %   \draw[>=latex,->] (1.25, -2.5) -- (2.5, -2.5) node[midway, above] {$\amessage_3$};
    %
    %   \draw (0.6, -3.35) node{$\cdots$};
    %   \draw (1.9, -3.35) node{$\cdots$};
    %
    %
		% \end{scope}
\end{tikzpicture}
\captionof{figure}{System $\systemexist$}
\label{fig:system_exist}

\end{center}

%\end{figure}
